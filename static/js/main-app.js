var oe=Object.defineProperty;var se=(t,e,n)=>e in t?oe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var U=(t,e,n)=>se(t,typeof e!="symbol"?e+"":e,n);function E(){}function te(t){return t()}function G(){return Object.create(null)}function I(t){t.forEach(te)}function ne(t){return typeof t=="function"}function ce(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function ae(t){return Object.keys(t).length===0}function g(t,e){t.appendChild(e)}function S(t,e,n){t.insertBefore(e,n||null)}function b(t){t.parentNode&&t.parentNode.removeChild(t)}function v(t){return document.createElement(t)}function D(t){return document.createTextNode(t)}function L(){return D(" ")}function H(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function w(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function fe(t){return Array.from(t.childNodes)}function F(t,e){e=""+e,t.data!==e&&(t.data=e)}function y(t,e,n){t.classList.toggle(e,!!n)}let R;function J(t){R=t}function ue(){if(!R)throw new Error("Function called outside component initialization");return R}function re(t){ue().$$.on_mount.push(t)}const j=[],K=[];let B=[];const Q=[],de=Promise.resolve();let q=!1;function he(){q||(q=!0,de.then(le))}function x(t){B.push(t)}const V=new Set;let A=0;function le(){if(A!==0)return;const t=R;do{try{for(;A<j.length;){const e=j[A];A++,J(e),_e(e.$$)}}catch(e){throw j.length=0,A=0,e}for(J(null),j.length=0,A=0;K.length;)K.pop()();for(let e=0;e<B.length;e+=1){const n=B[e];V.has(n)||(V.add(n),n())}B.length=0}while(j.length);for(;Q.length;)Q.pop()();q=!1,V.clear(),J(t)}function _e(t){if(t.fragment!==null){t.update(),I(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(x)}}function pe(t){const e=[],n=[];B.forEach(l=>t.indexOf(l)===-1?e.push(l):n.push(l)),n.forEach(l=>l()),B=e}const ge=new Set;function ie(t,e){t&&t.i&&(ge.delete(t),t.i(e))}function X(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}function me(t,e){t.d(1),e.delete(t.key)}function we(t,e,n,l,d,h,u,s,r,i,m,c){let o=t.length,a=h.length,_=o;const M={};for(;_--;)M[t[_].key]=_;const W=[],C=new Map,N=new Map,P=[];for(_=a;_--;){const f=c(d,h,_),p=n(f);let k=u.get(p);k?P.push(()=>k.p(f,e)):(k=i(p,f),k.c()),C.set(p,W[_]=k),p in M&&N.set(p,Math.abs(_-M[p]))}const O=new Set,$=new Set;function z(f){ie(f,1),f.m(s,m),u.set(f.key,f),m=f.first,a--}for(;o&&a;){const f=W[a-1],p=t[o-1],k=f.key,T=p.key;f===p?(m=f.first,o--,a--):C.has(T)?!u.has(k)||O.has(k)?z(f):$.has(T)?o--:N.get(k)>N.get(T)?($.add(k),z(f)):(O.add(T),o--):(r(p,u),o--)}for(;o--;){const f=t[o];C.has(f.key)||r(f,u)}for(;a;)z(W[a-1]);return I(P),W}function ve(t,e,n){const{fragment:l,after_update:d}=t.$$;l&&l.m(e,n),x(()=>{const h=t.$$.on_mount.map(te).filter(ne);t.$$.on_destroy?t.$$.on_destroy.push(...h):I(h),t.$$.on_mount=[]}),d.forEach(x)}function $e(t,e){const n=t.$$;n.fragment!==null&&(pe(n.after_update),I(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ke(t,e){t.$$.dirty[0]===-1&&(j.push(t),he(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function be(t,e,n,l,d,h,u=null,s=[-1]){const r=R;J(t);const i=t.$$={fragment:null,ctx:[],props:h,update:E,not_equal:d,bound:G(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(r?r.$$.context:[])),callbacks:G(),dirty:s,skip_bound:!1,root:e.target||r.$$.root};u&&u(i.root);let m=!1;if(i.ctx=n?n(t,e.props||{},(c,o,...a)=>{const _=a.length?a[0]:o;return i.ctx&&d(i.ctx[c],i.ctx[c]=_)&&(!i.skip_bound&&i.bound[c]&&i.bound[c](_),m&&ke(t,c)),o}):[],i.update(),m=!0,I(i.before_update),i.fragment=l?l(i.ctx):!1,e.target){if(e.hydrate){const c=fe(e.target);i.fragment&&i.fragment.l(c),c.forEach(b)}else i.fragment&&i.fragment.c();e.intro&&ie(t.$$.fragment),ve(t,e.target,e.anchor),le()}J(r)}class ye{constructor(){U(this,"$$");U(this,"$$set")}$destroy(){$e(this,1),this.$destroy=E}$on(e,n){if(!ne(n))return E;const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const d=l.indexOf(n);d!==-1&&l.splice(d,1)}}$set(e){this.$$set&&!ae(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Se="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Se);function Y(t,e,n){const l=t.slice();return l[6]=e[n],l}function Z(t){let e;return{c(){e=v("span"),e.textContent="Пока нет активных событий",w(e,"class","empty")},m(n,l){S(n,e,l)},p:E,d(n){n&&b(e)}}}function Ee(t){let e,n=t[6].data.full_name+"",l,d,h,u=new Date(t[6].time).toLocaleString()+"",s;return{c(){e=v("div"),l=D(n),d=L(),h=v("div"),s=D(u),w(e,"class","data"),w(h,"class","ceated")},m(r,i){S(r,e,i),g(e,l),S(r,d,i),S(r,h,i),g(h,s)},p(r,i){i&1&&n!==(n=r[6].data.full_name+"")&&F(l,n),i&1&&u!==(u=new Date(r[6].time).toLocaleString()+"")&&F(s,u)},d(r){r&&(b(e),b(d),b(h))}}}function We(t){let e;return{c(){e=v("div"),e.textContent="Неизвестный абонент",w(e,"class","empty-data")},m(n,l){S(n,e,l)},p:E,d(n){n&&b(e)}}}function Ce(t){let e;return{c(){e=v("div"),e.textContent="Загрузка данных ...",w(e,"class","loading-data")},m(n,l){S(n,e,l)},p:E,d(n){n&&b(e)}}}function ee(t,e){let n,l,d=e[6].action+"",h,u,s,r,i=e[6].phone+"",m,c,o,a=e[6].status+"",_,M,W,C,N;function P(f,p){return f[6].data===null?Ce:f[6].data.login===void 0?We:Ee}let O=P(e),$=O(e);function z(){return e[1](e[6])}return{key:t,first:null,c(){n=v("div"),l=v("div"),h=D(d),u=L(),s=v("div"),r=v("div"),m=D(i),c=L(),o=v("div"),_=D(a),M=L(),$.c(),W=L(),w(l,"class","action-type"),w(r,"class","phone"),w(o,"class","status"),w(s,"class","action-body"),w(n,"role","button"),w(n,"tabindex","0"),w(n,"class","action-item"),y(n,"clickable",e[6].data!==null&&e[6].data.login!==void 0),y(n,"welcome",e[6].action==="welcome"),y(n,"calling",e[6].action==="calling"),y(n,"answered",e[6].action==="answered"),this.first=n},m(f,p){S(f,n,p),g(n,l),g(l,h),g(n,u),g(n,s),g(s,r),g(r,m),g(s,c),g(s,o),g(o,_),g(s,M),$.m(s,null),g(n,W),C||(N=[H(n,"keypress",je),H(n,"click",z)],C=!0)},p(f,p){e=f,p&1&&d!==(d=e[6].action+"")&&F(h,d),p&1&&i!==(i=e[6].phone+"")&&F(m,i),p&1&&a!==(a=e[6].status+"")&&F(_,a),O===(O=P(e))&&$?$.p(e,p):($.d(1),$=O(e),$&&($.c(),$.m(s,null))),p&1&&y(n,"clickable",e[6].data!==null&&e[6].data.login!==void 0),p&1&&y(n,"welcome",e[6].action==="welcome"),p&1&&y(n,"calling",e[6].action==="calling"),p&1&&y(n,"answered",e[6].action==="answered")},d(f){f&&b(n),$.d(),C=!1,I(N)}}}function Oe(t){let e,n,l,d,h,u,s=[],r=new Map,i=X(t[0]);const m=o=>o[6].event_id;for(let o=0;o<i.length;o+=1){let a=Y(t,i,o),_=m(a);r.set(_,s[o]=ee(_,a))}let c=null;return i.length||(c=Z()),{c(){e=v("div"),n=v("h1"),n.textContent="Активные события",l=L(),d=v("hr"),h=L(),u=v("div");for(let o=0;o<s.length;o+=1)s[o].c();c&&c.c(),w(u,"class","action-field"),w(e,"class","app-container svelte-w272x")},m(o,a){S(o,e,a),g(e,n),g(e,l),g(e,d),g(e,h),g(e,u);for(let _=0;_<s.length;_+=1)s[_]&&s[_].m(u,null);c&&c.m(u,null)},p(o,[a]){a&1&&(i=X(o[0]),s=we(s,a,m,1,o,i,r,u,me,ee,null,Y),!i.length&&c?c.p(o,a):i.length?c&&(c.d(1),c=null):(c=Z(),c.c(),c.m(u,null)))},i:E,o:E,d(o){o&&b(e);for(let a=0;a<s.length;a+=1)s[a].d();c&&c.d()}}}function Le(t){}function Me(t){console.log("WS close: ",t)}function Ne(t){console.log("WS error: ",t)}function Ae(t){!t.data||t.data.profile_url===void 0||window.open(t.data.profile_url,"_blank")}const je=()=>{};function De(t,e,n){let l=null;const d="ws:"+window.location.host+"/ws";let h=[{phone:"+79217809021",action:"welcome",status:"user",time:new Date,event_id:"1729243964.366",support_id:"501",data:{}}];function u({data:i}){const m=JSON.parse(i);console.log("WS message: ",m),n(0,h=m)}function s(){(!l||l.readyState==WebSocket.CLOSED)&&(l=new WebSocket(d),l.onopen=Le,l.onmessage=u,l.onclose=Me,l.onerror=Ne)}return re(()=>{s()}),[h,i=>Ae(i)]}class Be extends ye{constructor(e){super(),be(this,e,De,Oe,ce,{})}}new Be({target:document.getElementById("app")});
